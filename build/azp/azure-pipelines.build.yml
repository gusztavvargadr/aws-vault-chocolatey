jobs:
  - job: build
    displayName: Build

    pool:
      vmImage: windows-2019

    steps:
      - template: azure-pipelines.core.yml

      - script: |
          dotnet cake build.cake --target=publish --package-version=$(package-version) --project-version=$(project-version)
        displayName: Cake Publish

      - script: |
          dotnet cake build.cake --target=clean --package-version=$(package-version) --project-version=$(project-version)
        displayName: Cake Clean
        condition: always()

      - publish: $(Build.SourcesDirectory)/.chocolatey/
        artifact: build-chocolatey
        displayName: Artifacts Chocolatey Publish
        condition: always()
